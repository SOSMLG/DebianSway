### Improved MPV Configuration - Optimized & Sunset Themed ###
# Save as: ~/.config/mpv/mpv.conf

# ==================== Hardware Acceleration ====================
# Optimized for AMD GPU (based on your amdgpu_bl0 backlight)
hwdec=auto-safe                         # Safe hardware decoding
vo=gpu-next                             # Modern high-quality video output
gpu-context=wayland                     # Wayland context
gpu-api=vulkan                          # Use Vulkan for better performance

# Quality settings
profile=gpu-hq                          # High quality rendering
scale=ewa_lanczossharp                  # High quality upscaling
cscale=ewa_lanczossharp                 # High quality chroma upscaling
dscale=mitchell                         # High quality downscaling
video-sync=display-resample             # Smooth playback synced to display

# ==================== Sunset Theme Colors ====================
# Matches your wallpaper and SwayNC theme
background-color='#1a2a3a'              # Deep navy background
osd-back-color='#0f1e2d'                # Darker navy for OSD background
osd-border-color='#ff6b85'              # Coral/pink border
osd-color='#ffd4a3'                     # Warm golden text
osd-shadow-color='#1a2a3a'              # Shadow color

# ==================== OSD/OSC Settings ====================
osc=no                                  # Disable default OSC (using uosc)
osd-bar=no                              # uosc handles this
osd-font='JetBrainsMono Nerd Font'      # Match your system font
osd-font-size=32                        # Readable size
osd-border-size=2                       # Clear borders
osd-bar-align-y=-1                      # Top alignment
osd-bar-h=3                             # Bar height
osd-bar-w=60                            # Bar width

# ==================== UOSC Theme (Sunset Colors) ====================
script-opts-append=uosc-color=foreground=ff6b85,foreground_text=ffd4a3,background=1a2a3a,background_text=ffd4a3,curtain=0f1e2d,success=a6da95,error=ff4757

# ==================== Stats Script (Sunset Colors) ====================
script-opts-append=stats-border_color=3a2a1a
script-opts-append=stats-font_color=a3d4ff
script-opts-append=stats-plot_bg_border_color=856bff
script-opts-append=stats-plot_bg_color=2d1e0f
script-opts-append=stats-plot_color=856bff

# ==================== Screenshots ====================
screenshot-template="~/Pictures/Screenshots/mpv-%F-T%wH.%wM.%wS"
screenshot-format=png
screenshot-png-compression=7            # Balanced compression (0-9)
screenshot-tag-colorspace=yes
screenshot-high-bit-depth=yes

# ==================== Subtitles ====================
# Arabic & English support
slang=ar,ara,arabic,en,eng,english
alang=en,eng,english,ar,ara,arabic
sub-auto=fuzzy                          # Auto-load external subs
sub-file-paths=ass:srt:sub:subs:subtitles    # Search paths

# Subtitle styling
sub-font="Noto Sans Arabic"             # Better Arabic font
sub-font-size=55                        # Readable size
sub-color='#ffd4a3'                     # Warm golden (matching theme)
sub-border-size=3                       # Clear borders
sub-border-color='#1a2a3a'              # Dark border
sub-shadow-offset=1                     # Subtle shadow
sub-shadow-color='#000000'
sub-margin-y=50                         # Bottom margin
sub-blur=0.2                            # Slight blur for smoothness
stretch-image-subs-to-screen=yes
sub-visibility=yes                      # Show subs by default
subs-with-matching-audio=no             # Show subs even with matching audio

# ==================== Audio ====================
audio-file-auto=fuzzy                   # Auto-load external audio
volume-max=150                          # Max 150% volume
volume=70                               # Default 70%
audio-channels=stereo                   # Stereo output
audio-normalize-downmix=yes             # Normalize when downmixing

# ==================== Playback ====================
keep-open=yes                           # Don't close after playback
keep-open-pause=no                      # Don't pause at end
save-position-on-quit=yes               # Remember position
watch-later-options=start,vid,aid,sid   # What to save

# ==================== Cache & Network ====================
cache=yes
demuxer-max-bytes=400M                  # 400MB cache
demuxer-max-back-bytes=150M             # 150MB backward cache
cache-pause-initial=yes                 # Pause until cache fills
cache-pause-wait=5                      # Wait 5 seconds

# ==================== YouTube (yt-dlp) ====================
ytdl=yes
ytdl-format=bestvideo[height<=1080][vcodec!=vp9]+bestaudio/best[height<=1080]
script-opts-append=ytdl_hook-try_ytdl_first=yes

# ==================== Window ====================
autofit=70%                             # Start at 70% screen size
autofit-larger=90%x90%                  # Max 90% screen size
force-window=immediate                  # Show window immediately
cursor-autohide=1000                    # Hide cursor after 1s
keepaspect=yes                          # Keep aspect ratio
keepaspect-window=no                    # Don't letterbox window

# ==================== Performance ====================
video-latency-hacks=yes                 # Reduce latency
opengl-swapinterval=1                   # VSync on
interpolation=yes                       # Smooth motion
tscale=oversample                       # Temporal interpolation

# ==================== Misc ====================
msg-color=yes                           # Colored terminal output
msg-module=yes                          # Show module names
term-osd-bar=yes                        # Show progress bar in terminal
use-filedir-conf=yes                    # Use per-directory config files
write-filename-in-watch-later-config=yes
ignore-path-in-watch-later-config=yes

# ==================== Profiles ====================

# High quality profile (use with: mpv --profile=hq video.mkv)
[hq]
profile=gpu-hq
scale=ewa_lanczossharp
cscale=ewa_lanczossharp
dscale=mitchell
deband=yes

# Low latency for gaming/streaming
[low-latency]
video-latency-hacks=yes
opengl-swapinterval=0
interpolation=no
video-sync=audio

# Battery saving mode
[battery]
hwdec=auto-safe
profile=fast
scale=bilinear
cscale=bilinear
video-sync=audio
interpolation=no

# Protocol specific profiles
[protocol.http]
cache=yes
hls-bitrate=max
user-agent="Mozilla/5.0"

[protocol.https]
profile=protocol.http

[protocol.ytdl]
profile=protocol.http
cache=yes

# Extension specific profiles
[extension.gif]
loop-file=inf

[extension.webm]
loop-file=inf

# 4K video optimization
[4k]
profile=gpu-hq
hwdec=auto-safe
vd-lavc-dr=yes
opengl-pbo=yes

# HDR content
[hdr]
target-prim=bt.2020
target-trc=pq
tone-mapping=hable
hdr-compute-peak=yes
